{
    "properties": {
        "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
        "displayName": "Deny Public network access for PaaS services",
        "parameters": {
            "KeyVaultDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Key Vault",
                    "description": "This policy prevents creation of Key Vault with exposed public endpoints."
                }
            },
            "CognitiveServicesDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Cognitive Services",
                    "description": "This policy prevents creation of Cognitive Services with exposed public endpoints."
                }
            },
            "DatabricksWorkspaceDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Databricks Workspace",
                    "description": "This policy prevents creation of Databricks Workspace with exposed public endpoints."
                }
            },
            "ContainerRegistryDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Container Registry",
                    "description": "This policy prevents creation of Container Registry with exposed public endpoints."
                }
            },
            "FunctionAppSlotsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Function App Slots",
                    "description": "This policy prevents creation of Function App Slots with exposed public endpoints."
                }
            },
            "EventGridTopicsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Event Grid Topics",
                    "description": "This policy prevents creation of Event Grid Topics with exposed public endpoints."
                }
            },
            "AppServiceAppsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for App Service App",
                    "description": "This policy prevents creation of App Service App with exposed public endpoints."
                }
            },
            "AzureSQLDatabaseDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure SQL Database",
                    "description": "This policy prevents creation of Azure SQL Database with exposed public endpoints."
                }
            },
            "AzureDataFactoryDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Data Factory",
                    "description": "This policy prevents creation of Azure Data Factory with exposed public endpoints."
                }
            },
            "AzureFileSyncDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure File Sync",
                    "description": "This policy prevents creation of Azure File Sync with exposed public endpoints."
                }
            },
            "AzureSignalRServiceDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure SignalR Service",
                    "description": "This policy prevents creation of Azure SignalR Service with exposed public endpoints."
                }
            },
            "AzureIoTHubDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure IoT Hub",
                    "description": "This policy prevents creation of Azure IoT Hub with exposed public endpoints."
                }
            },
            "AzureSynapseWorkspaceDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Synapse Workspace",
                    "description": "This policy prevents creation of Azure Synapse Workspace with exposed public endpoints."
                }
            },
            "AppConfigurationDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for App Configuration",
                    "description": "This policy prevents creation of App Configuration with exposed public endpoints."
                }
            },
            "AzureMachineLearningWorkspacesDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Machine Learning Workspace",
                    "description": "This policy prevents creation of Azure Machine Learning Workspace with exposed public endpoints."
                }
            },
            "AzureCacheForRedisDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Cache for Redis",
                    "description": "This policy prevents creation of Azure Cache for Redis with exposed public endpoints."
                }
            },
            "AppServiceAppSlotsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for App Service app slots",
                    "description": "This policy prevents creation of App Service app slots with exposed public endpoints."
                }
            },
            "BatchAccountsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Batch Accounts",
                    "description": "This policy prevents creation of Batch Accounts with exposed public endpoints."
                }
            },
            "AzureCosmosDBDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Cosmos DB",
                    "description": "This policy prevents creation of Azure Cosmos DB with exposed public endpoints."
                }
            },
            "AzureMediaServicesDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Media Services",
                    "description": "This policy prevents creation of Azure Media Services with exposed public endpoints."
                }
            },
            "AutomationAccountsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Automation Accounts",
                    "description": "This policy prevents creation of Automation Accounts with exposed public endpoints."
                }
            },
            "FunctionAppsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Function Apps",
                    "description": "This policy prevents creation of Function Apps with exposed public endpoints."
                }
            },
            "AzureSQLManagedInstanceDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure SQL Managed Instance",
                    "description": "This policy prevents creation of Azure SQL Managed Instance with exposed public endpoints."
                }
            },
            "StorageAccountsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Storage Accounts",
                    "description": "This policy prevents creation of Storage Accounts with exposed public endpoints."
                }
            },
            "ServiceBusNamespacesDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Service Bus Namespaces",
                    "description": "This policy prevents creation of Service Bus Namespaces with exposed public endpoints."
                }
            },
            "IoTHubDeviceProvisioningServiceDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for IoT Hub device provisioning service",
                    "description": "This policy prevents creation of IoT Hub device provisioning service with exposed public endpoints."
                }
            },
            "AzureCognitiveSearchServiceDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Cognitive Search Service",
                    "description": "This policy prevents creation of Azure Cognitive Search Service with exposed public endpoints."
                }
            },
            "AzureEventGridDomainsDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Azure Event Grid Domains",
                    "description": "This policy prevents creation of Azure Event Grid Domains with exposed public endpoints."
                }
            },
            "MariaDBDenyPaasPublicIPEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Deny public network acess for Maria DB",
                    "description": "This policy prevents creation of Maria DB with exposed public endpoints."
                }
            }
        },
        "policyDefinitionGroups": null,
        "metadata": {
            "version": "1.1.0",
            "category": "Network"
        },
        "PolicyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
                "policyDefinitionReferenceId": "KeyVaultDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('KeyVaultDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0725b4dd-7e76-479c-a735-68e7ee23d5ca",
                "policyDefinitionReferenceId": "CognitiveServicesDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('CognitiveServicesDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
                "policyDefinitionReferenceId": "DatabricksWorkspaceDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('DatabricksWorkspaceDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                "policyDefinitionReferenceId": "ContainerRegistryDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ContainerRegistryDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/11c82d0c-db9f-4d7b-97c5-f3f9aa957da2",
                "policyDefinitionReferenceId": "FunctionAppSlotsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('FunctionAppSlotsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1adadefe-5f21-44f7-b931-a59b54ccdb45",
                "policyDefinitionReferenceId": "EventGridTopicsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('EventGridTopicsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
                "policyDefinitionReferenceId": "AppServiceAppsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AppServiceAppsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                "policyDefinitionReferenceId": "AzureSQLDatabaseDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureSQLDatabaseDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6",
                "policyDefinitionReferenceId": "AzureDataFactoryDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureDataFactoryDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                "policyDefinitionReferenceId": "AzureFileSyncDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureFileSyncDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a9766a-82a5-4747-abb5-650b6dbba6d0",
                "policyDefinitionReferenceId": "AzureSignalRServiceDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureSignalRServiceDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d6830fb-07eb-48e7-8c4d-2a442b35f0fb",
                "policyDefinitionReferenceId": "AzureIoTHubDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureIoTHubDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/38d8df46-cf4e-4073-8e03-48c24b29de0d",
                "policyDefinitionReferenceId": "AzureSynapseWorkspaceDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureSynapseWorkspaceDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3d9f5e4c-9947-4579-9539-2a7695fbc187",
                "policyDefinitionReferenceId": "AppConfigurationDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AppConfigurationDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
                "policyDefinitionReferenceId": "AzureMachineLearningWorkspacesDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureMachineLearningWorkspacesDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
                "policyDefinitionReferenceId": "AzureCacheForRedisDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureCacheForRedisDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/701a595d-38fb-4a66-ae6d-fb3735217622",
                "policyDefinitionReferenceId": "AppServiceAppSlotsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AppServiceAppSlotsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                "policyDefinitionReferenceId": "BatchAccountsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('BatchAccountsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                "policyDefinitionReferenceId": "AzureCosmosDBDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureCosmosDBDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8bfe3603-0888-404a-87ff-5c1b6b4cc5e3",
                "policyDefinitionReferenceId": "AzureMediaServicesDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureMediaServicesDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
                "policyDefinitionReferenceId": "AutomationAccountsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AutomationAccountsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/969ac98b-88a8-449f-883c-2e9adb123127",
                "policyDefinitionReferenceId": "FunctionAppsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('FunctionAppsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
                "policyDefinitionReferenceId": "AzureSQLManagedInstanceDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureSQLManagedInstanceDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
                "policyDefinitionReferenceId": "StorageAccountsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('StorageAccountsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cbd11fd3-3002-4907-b6c8-579f0e700e13",
                "policyDefinitionReferenceId": "ServiceBusNamespacesDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ServiceBusNamespacesDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d82101f3-f3ce-4fc5-8708-4c09f4009546",
                "policyDefinitionReferenceId": "IoTHubDeviceProvisioningServiceDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('IoTHubDeviceProvisioningServiceDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee980b6d-0eca-4501-8d54-f6290fd512c3",
                "policyDefinitionReferenceId": "AzureCognitiveSearchServiceDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureCognitiveSearchServiceDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8f774be-6aee-492a-9e29-486ef81f3a68",
                "policyDefinitionReferenceId": "AzureEventGridDomainsDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureEventGridDomainsDenyPaasPublicIPEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/mg-A2g/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
                "policyDefinitionReferenceId": "MariaDBDenyPaasPublicIP",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MariaDBDenyPaasPublicIPEffect')]"
                    }
                }
            }
        ]
    },
    "name": "Deny-PaaS-PublicEndpoints"
}